<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <script src="js/rem.js"></script>
    <link rel="stylesheet" href="css/chengshi.css">
    <link rel="stylesheet" href="icon/iconfont.css">
    <title>Document</title>
</head>
<body>
    <div class="blue">
        <img src="img/screen.png" alt="">
        <div class="position">
            <i class="iconfont icon-weizhi"></i>
            <span class="city">太原市 阳曲县</span>
            <img src="img/tupian.png" alt="">
        </div>
        <div class="kongqi">
            <span>空气</span><br>
            <span class="kongqizhuangkuang">轻度污染</span>
        </div>
        <div class="juti">
            <span class="wendu">&nbsp0°</span>
            <span class="wenduzhuangkuang">晴</span>
            <span class="fengji">湿度 28%</span><br>
            <p>天冷了，注意保暖~ </p>
        </div>
    </div>
    <div class="yubao">
        <div class="jintian">
            <span>今天</span>
            <span class="gaodi">2/-11℃</span>
            <span class="gaodizhuangkuang">晴转多云</span>
            <img src="img/0.png" alt="">
        </div>
        <div class="mingtian">
            <span>明天</span>
            <span class="mtgaodi">3/-13℃</span>
            <span class="mtgaodizk">晴</span>
            <img src="img/0.png" alt="">
        </div>
    </div>
    <div class="jiange"></div>
    <div class="time">
        <ul>
        </ul>
    </div>
    <div class="jiange"></div>
    <div class="quxian">
        <ul class="quxian1">
            <li>
                <span>昨天</span>
                <span>01/15</span>
                <span>多云</span>
                <img src="img/1.png" alt="">
            </li>
            <li>
                <span>今天</span>
                <span>01/16</span>
                <span>晴</span>
                <img src="img/0.png" alt="">
            </li>
            <li>
                <span>明天</span>
                <span>01/17</span>
                <span>晴</span>
                <img src="img/0.png" alt="">
            </li>
            <li>
                <span>后天</span>
                <span>01/18</span>
                <span>多云</span>
                <img src="img/1.png" alt="">
            </li>
            <li>
                <span>周五</span>
                <span>01/19</span>
                <span>晴</span>
                <img src="img/0.png" alt="">
            </li>
            <li>
                <span>周六</span>
                <span>01/20</span>
                <span>晴</span>
                <img src="img/0.png" alt="">
            </li>
        </ul>
        <ul class="quxian2">
            <li>
                <img src="img/31.png" alt="">
                <span>多云</span>
                <span>西北风</span>
                <span>3级</span>
            </li>
            <li>
                <img src="img/31.png" alt="">
                <span>多云</span>
                <span>西南风</span>
                <span>3级</span>
            </li>
            <li>
                <img src="img/30.png" alt="">
                <span>晴</span>
                <span>西北风</span>
                <span>4级</span>
            </li>
            <li>
                <img src="img/30.png" alt="">
                <span>晴</span>
                <span>西风</span>
                <span>3级</span>
            </li>
            <li>
                <img src="img/30.png" alt="">
                <span>晴</span>
                <span>西风</span>
                <span>3级</span>
            </li>
            <li>
                <img src="img/31.png" alt="">
                <span>多云</span>
                <span>西风</span>
                <span>3级</span>
            </li>
        </ul>
    </div>
    <div class="jiange"></div>
    <div class="catalog">
        <ul>
            <li>
                <i class="iconfont icon-yusan"></i>
                <span>不带伞</span>
                <span>雨伞</span>
            </li>
            <li>
                <i class="iconfont icon-yifu"></i>
                <span>冷</span>
                <span>穿衣</span>
            </li>
            <li>
                <i class="iconfont icon-taiyangtianqi"></i>
                <span>较弱</span>
                <span>防晒</span>
            </li>
            <li>
                <i class="iconfont icon-jiaonang"></i>
                <span>较易发</span>
                <span>感冒</span>
            </li>
            <li>
                <i class="iconfont icon-lanqiu"></i>
                <span>较不宜</span>
                <span>运动</span>
            </li>
            <li>
                <i class="iconfont icon-qiche"></i>
                <span>较适宜</span>
                <span>洗车</span>
            </li>
            <li>
                <i class="iconfont icon-tubiao-"></i>
                <span>不宜</span>
                <span>钓鱼</span>
            </li>
            <li>
                <i class="iconfont icon-honglvdengweizhang"></i>
                <span>良好</span>
                <span>交通</span>
            </li>
        </ul>
    </div>
    <div class="jiange2">
        <span>数据来源于中国天气网</span>
    </div>
    <div class="location">
        <div class="input">
            <input type="text" placeholder="搜索市、区、县" >
            <a class="text444">取消</a>
        </div>
        <div class="location-1">当前定位
            <a href="">小店区</a>
        </div>
    </div>

</body>
</html>
<script src="js/jquery-3.3.1.min.js"></script>
<script>

    // 1.获取默认城市的天气信息
    // 2.获取所有城市的信息
    // 3.点击每个城市可以获取当前城市的天气信息
    // 4.在搜索框内输入要搜索的城市，点击搜索按钮可以进行搜索






    // $(function () {
        let tianqi;
    	$.ajax({
            type:'get',
            url:'https://www.toutiao.com/stream/widget/local_weather/data/?city=太原',
            dataType:'jsonp',
            success:function (obj) {
                console.log(obj);
                tianqi=obj.data;
                updata(tianqi);
			}
        });
        function updata(tianqi) {
			// 获取当前城市
			$('.city').html(tianqi.city);
			$('.kongqizhuangkuang').html(tianqi.weather.quality_level);
			$('.wendu').html(tianqi.weather.current_temperature+'°');
			$('.wenduzhuangkuang').html(tianqi.weather.current_condition);
			$('.fengji').html(tianqi.weather.wind_direction+tianqi.weather.wind_level+'级');
			$('.gaodi').html(tianqi.weather.low_temperature+'/'+tianqi.weather.high_temperature+'℃');
			$('.gaodizhuangkuang').html(tianqi.weather.dat_condition);
			$('.jintian img').attr('src','img/'+tianqi.weather.dat_weather_icon_id+'.png');
			$('.mtgaodi').html(tianqi.weather.tomorrow_low_temperature+'/'+tianqi.weather.tomorrow_high_temperature+'℃');
			$('.mtgaodizk').html(tianqi.weather.tomorrow_condition);
			$('.mingtian img').attr('src','img/'+tianqi.weather.tomorrow_weather_icon_id+'.png');


			console.log(tianqi.weather.weather_icon_id);
			let weather= tianqi.weather.hourly_forecast;
			weather.forEach(function (v,i) {
				console.log(weather[i].weather_icon_id);
                let str=`<li>
                            <span>${v.hour}:00</span>
                            <img src="img/${weather[i].weather_icon_id}.png" alt="">
                            <span>${v.temperature}℃</span>
                        </li>`;
                $('.time ul').append(str);
			    });
		}

		$('.city').click(function () {
            $('.location').css({'display':'block'});
            $('.blue').css({'display':'none'});
			$('.yubao').css({'display':'none'});
			$('.jiange').css({'display':'none'});
			$('.time').css({'display':'none'});
			$('.quxian').css({'display':'none'});
			$('.jiange2').css({'display':'none'});
			$('.catalog').css({'display':'none'});


		});

        $('.input input').focus(function () {
            $('.text444').html('搜索');
        });
        // let text1=$('input').val();
        // console.log(text1);
        // ajaxs(text1);
        $('.input a').click(function () {
            if($('.input a').val()==='取消'){
				let text1=$('input').val();
                $('.location').css({'display':'none'});
                $('.blue').css({'display':'block'});
                $('.yubao').css({'display':'block'});
                $('.jiange').css({'display':'block'});
                $('.time').css({'display':'block'});
                $('.quxian').css({'display':'block'});
                $('.jiange2').css({'display':'block'});
                $('.catalog').css({'display':'block'});

            }else{
				let text1=$('input').val();
                $('.location').css({'display':'none'});
                $('.blue').css({'display':'block'});
                $('.yubao').css({'display':'block'});
                $('.jiange').css({'display':'block'});
                $('.time').css({'display':'block'});
                $('.quxian').css({'display':'block'});
                $('.jiange2').css({'display':'block'});
                $('.catalog').css({'display':'block'});
				ajaxs(text1);
            }

        });


	let city;
        $.ajax({
            type:'get',
            url:'https://www.toutiao.com/stream/widget/local_weather/city/',
            dataType:'jsonp',
            success:function (obj) {
                console.log(obj);
                city=obj.data;
                updataCity(city);
            }
        });
        function updataCity(city) {
            for(let i in city ){
                let str=`<div class="location-2">${i}</div>
                                <ul class="hotscenic1"></ul>`;
                $('.location').append(str);
                for (let j in city[i]){
                    let li=document.createElement('li');
                    $('.location ul').append(li);
                    li.classList.add('ghj');
                    li.innerHTML=j;
                }
            }
        }

	// });

	function ajaxs(str){
		$.ajax({
			type:'get',
			url:'https://www.toutiao.com/stream/widget/local_weather/data/?city='+str,
			dataType:'jsonp',
			success:function (obj) {
				let tianqi2=obj.data;
				updata(tianqi2);
			}
		});
	}
    window.onload=function(){

        $('.location li').click(function () {
			console.log($('.location li'));
			$('.location').css({'display':'none'});
			$('.blue').css({'display':'block'});
			$('.yubao').css({'display':'block'});
			$('.jiange').css({'display':'block'});
			$('.time').css({'display':'block'});
			$('.quxian').css({'display':'block'});
			$('.jiange2').css({'display':'block'});
			$('.catalog').css({'display':'block'});
            let con =$(this).html();
            console.log(con);
            ajaxs(con);
        });
    };





















</script>